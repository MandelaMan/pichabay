{"ast":null,"code":"var _jsxFileName = \"C:\\\\React\\\\pichabay\\\\src\\\\context\\\\GlobalState.js\";\nimport React, { createContext, useReducer, useEffect } from \"react\";\nimport AppReducer from \"./AppReducer\";\nimport axios from \"axios\";\nimport { encryptData, decryptData, readJwt, addCookie, deleteCookie } from \"../utils/helpers\";\nimport Cookies from \"js-cookie\";\nimport { photographers } from \"../utils/data\";\nimport { createBrowserHistory } from \"history\";\nconst initialState = {\n  isLoading: false,\n  isLoggedIn: null,\n  categories: [],\n  counties: [],\n  home_photographers: [],\n  searched_photographers: [],\n  category_based_photographers: [],\n  user_info: {}\n};\nimport _ from \"lodash\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const GlobalContext = /*#__PURE__*/createContext(initialState);\nexport const GlobalProvider = _ref => {\n  let {\n    children\n  } = _ref;\n  const history = createBrowserHistory();\n  const [state, dispatch] = useReducer(AppReducer, initialState);\n  const baseURL = \"http://localhost:81/kliks/v1/api\"; // const baseURL = \"https://www.pichabay.com/v1/api\";\n\n  async function fetchCategories() {\n    try {\n      const config = {\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      };\n      const res = await axios.get(`${baseURL}/categories`, config);\n\n      if (res.data) {\n        dispatch({\n          type: \"GET_CATEGORIES\",\n          payload: res.data\n        });\n      }\n    } catch (error) {\n      console.log(error.message);\n    }\n  }\n\n  function setLoadingStatus(action) {\n    dispatch({\n      type: \"SET_LOADING_STATUS\",\n      payload: action\n    });\n  }\n\n  function setGlobalInfo(info) {\n    dispatch({\n      type: \"SET_USER_INFO\",\n      payload: info\n    });\n  }\n\n  function checkLoginStatus() {\n    let login = false;\n\n    if (localStorage.PLUD) {\n      const info = readJwt(decryptData(localStorage.PLUD));\n      login = true;\n      setGlobalInfo(info);\n    }\n\n    dispatch({\n      type: \"LOGIN_STATUS\",\n      payload: login\n    });\n  }\n\n  async function userLogin(inputs) {\n    setLoadingStatus(true);\n\n    try {\n      const config = {\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      };\n      const res = await axios.post(`${baseURL}/users/login`, inputs, config);\n\n      if (!res.data.error) {\n        localStorage.PLUD = encryptData(res.data.token);\n        setTimeout(function () {\n          checkLoginStatus();\n          setLoadingStatus(false);\n          history.push(\"/\");\n          window.location.reload();\n        }, 200);\n      }\n    } catch (error) {}\n  }\n\n  async function userRegistration(inputs) {\n    setLoadingStatus(true);\n\n    try {\n      const config = {\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      };\n      const res = await axios.post(`${baseURL}/users/register`, inputs, config);\n      console.log(res.data);\n\n      if (!res.data.error) {\n        localStorage.PLUD = encryptData(res.data.token);\n        setTimeout(function () {\n          checkLoginStatus();\n          setLoadingStatus(false);\n        }, 200);\n      }\n    } catch (error) {}\n  }\n\n  async function logOutUser() {\n    try {\n      localStorage.clear();\n      window.location.reload();\n      setTimeout(function () {\n        checkLoginStatus();\n      }, 200);\n    } catch (error) {\n      console.log(error.message);\n    }\n  }\n\n  async function fetchHomePhotographers() {// if (\n    //   localStorage.hasOwnProperty(\"_search\") &&\n    //   !_.isEmpty(JSON.parse(localStorage._search))\n    // ) {\n    //   const updated_search = JSON.parse(localStorage._search);\n    //   searchPhotographer(updated_search);\n    // }\n  }\n\n  async function fetchSearchedPhotographer(data) {\n    setLoadingStatus(true);\n    console.log(data.location);\n\n    try {\n      const config = {\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      };\n      const res = await axios.get(`${baseURL}/search?category=${data.category}&location=${data.location}&booked_on=${data.booked_on}`, config);\n\n      if (res) {\n        dispatch({\n          type: \"GET_SEARCHED_PHOTOGRAPHERS\",\n          payload: res.data\n        });\n        console.log(res.data); // return true;\n      }\n    } catch (error) {// console.log(error.message);\n    }\n\n    history.push(\"/photographers\");\n    window.location.reload(); // setTimeout(setLoadingStatus(false), 17000);\n  }\n\n  useEffect(() => {\n    checkLoginStatus();\n    fetchCategories(); // fetchPhotographers();\n\n    return () => {// cleanup;\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(GlobalContext.Provider, {\n    value: {\n      fetchCategories,\n      userLogin,\n      userRegistration,\n      setLoadingStatus,\n      logOutUser,\n      fetchHomePhotographers,\n      fetchSearchedPhotographer,\n      fetchCategoryPhotographer,\n      home_photographers: state.home_photographers,\n      searched_photographers: state.searched_photographers,\n      category_based_photographers: state.category_based_photographers,\n      isLoggedIn: state.isLoggedIn,\n      user_info: state.user_info,\n      categories: state.categories,\n      isLoading: state.isLoading\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 210,\n    columnNumber: 5\n  }, this);\n};","map":{"version":3,"sources":["C:/React/pichabay/src/context/GlobalState.js"],"names":["React","createContext","useReducer","useEffect","AppReducer","axios","encryptData","decryptData","readJwt","addCookie","deleteCookie","Cookies","photographers","createBrowserHistory","initialState","isLoading","isLoggedIn","categories","counties","home_photographers","searched_photographers","category_based_photographers","user_info","_","GlobalContext","GlobalProvider","children","history","state","dispatch","baseURL","fetchCategories","config","headers","res","get","data","type","payload","error","console","log","message","setLoadingStatus","action","setGlobalInfo","info","checkLoginStatus","login","localStorage","PLUD","userLogin","inputs","post","token","setTimeout","push","window","location","reload","userRegistration","logOutUser","clear","fetchHomePhotographers","fetchSearchedPhotographer","category","booked_on","fetchCategoryPhotographer"],"mappings":"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","sourcesContent":["import React, { createContext, useReducer, useEffect } from \"react\";\r\nimport AppReducer from \"./AppReducer\";\r\nimport axios from \"axios\";\r\nimport {\r\n  encryptData,\r\n  decryptData,\r\n  readJwt,\r\n  addCookie,\r\n  deleteCookie,\r\n} from \"../utils/helpers\";\r\nimport Cookies from \"js-cookie\";\r\nimport { photographers } from \"../utils/data\";\r\nimport { createBrowserHistory } from \"history\";\r\n\r\nconst initialState = {\r\n  isLoading: false,\r\n  isLoggedIn: null,\r\n  categories: [],\r\n  counties: [],\r\n  home_photographers: [],\r\n  searched_photographers: [],\r\n  category_based_photographers: [],\r\n  user_info: {},\r\n};\r\nimport _ from \"lodash\";\r\n\r\nexport const GlobalContext = createContext(initialState);\r\n\r\nexport const GlobalProvider = ({ children }) => {\r\n  const history = createBrowserHistory();\r\n\r\n  const [state, dispatch] = useReducer(AppReducer, initialState);\r\n\r\n  const baseURL = \"http://localhost:81/kliks/v1/api\";\r\n  // const baseURL = \"https://www.pichabay.com/v1/api\";\r\n\r\n  async function fetchCategories() {\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      };\r\n\r\n      const res = await axios.get(`${baseURL}/categories`, config);\r\n\r\n      if (res.data) {\r\n        dispatch({\r\n          type: \"GET_CATEGORIES\",\r\n          payload: res.data,\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.log(error.message);\r\n    }\r\n  }\r\n\r\n  function setLoadingStatus(action) {\r\n    dispatch({\r\n      type: \"SET_LOADING_STATUS\",\r\n      payload: action,\r\n    });\r\n  }\r\n\r\n  function setGlobalInfo(info) {\r\n    dispatch({\r\n      type: \"SET_USER_INFO\",\r\n      payload: info,\r\n    });\r\n  }\r\n\r\n  function checkLoginStatus() {\r\n    let login = false;\r\n\r\n    if (localStorage.PLUD) {\r\n      const info = readJwt(decryptData(localStorage.PLUD));\r\n      login = true;\r\n      setGlobalInfo(info);\r\n    }\r\n    dispatch({\r\n      type: \"LOGIN_STATUS\",\r\n      payload: login,\r\n    });\r\n  }\r\n\r\n  async function userLogin(inputs) {\r\n    setLoadingStatus(true);\r\n\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      };\r\n\r\n      const res = await axios.post(`${baseURL}/users/login`, inputs, config);\r\n\r\n      if (!res.data.error) {\r\n        localStorage.PLUD = encryptData(res.data.token);\r\n\r\n        setTimeout(function () {\r\n          checkLoginStatus();\r\n\r\n          setLoadingStatus(false);\r\n\r\n          history.push(\"/\");\r\n          window.location.reload();\r\n        }, 200);\r\n      }\r\n    } catch (error) {}\r\n  }\r\n\r\n  async function userRegistration(inputs) {\r\n    setLoadingStatus(true);\r\n\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      };\r\n\r\n      const res = await axios.post(`${baseURL}/users/register`, inputs, config);\r\n\r\n      console.log(res.data);\r\n\r\n      if (!res.data.error) {\r\n        localStorage.PLUD = encryptData(res.data.token);\r\n\r\n        setTimeout(function () {\r\n          checkLoginStatus();\r\n\r\n          setLoadingStatus(false);\r\n        }, 200);\r\n      }\r\n    } catch (error) {}\r\n  }\r\n\r\n  async function logOutUser() {\r\n    try {\r\n      localStorage.clear();\r\n      window.location.reload();\r\n\r\n      setTimeout(function () {\r\n        checkLoginStatus();\r\n      }, 200);\r\n    } catch (error) {\r\n      console.log(error.message);\r\n    }\r\n  }\r\n\r\n  async function fetchHomePhotographers() {\r\n    // if (\r\n    //   localStorage.hasOwnProperty(\"_search\") &&\r\n    //   !_.isEmpty(JSON.parse(localStorage._search))\r\n    // ) {\r\n    //   const updated_search = JSON.parse(localStorage._search);\r\n    //   searchPhotographer(updated_search);\r\n    // }\r\n  }\r\n\r\n  async function fetchSearchedPhotographer(data) {\r\n    setLoadingStatus(true);\r\n\r\n    console.log(data.location);\r\n\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      };\r\n\r\n      const res = await axios.get(\r\n        `${baseURL}/search?category=${data.category}&location=${data.location}&booked_on=${data.booked_on}`,\r\n        config\r\n      );\r\n\r\n      if (res) {\r\n        dispatch({\r\n          type: \"GET_SEARCHED_PHOTOGRAPHERS\",\r\n          payload: res.data,\r\n        });\r\n\r\n        console.log(res.data);\r\n        // return true;\r\n      }\r\n    } catch (error) {\r\n      // console.log(error.message);\r\n    }\r\n\r\n    history.push(\"/photographers\");\r\n    window.location.reload();\r\n\r\n    // setTimeout(setLoadingStatus(false), 17000);\r\n  }\r\n\r\n  useEffect(() => {\r\n    checkLoginStatus();\r\n\r\n    fetchCategories();\r\n    // fetchPhotographers();\r\n\r\n    return () => {\r\n      // cleanup;\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <GlobalContext.Provider\r\n      value={{\r\n        fetchCategories,\r\n        userLogin,\r\n        userRegistration,\r\n        setLoadingStatus,\r\n        logOutUser,\r\n        fetchHomePhotographers,\r\n        fetchSearchedPhotographer,\r\n        fetchCategoryPhotographer,\r\n\r\n        home_photographers: state.home_photographers,\r\n        searched_photographers: state.searched_photographers,\r\n        category_based_photographers: state.category_based_photographers,\r\n        isLoggedIn: state.isLoggedIn,\r\n        user_info: state.user_info,\r\n        categories: state.categories,\r\n        isLoading: state.isLoading,\r\n      }}\r\n    >\r\n      {children}\r\n    </GlobalContext.Provider>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}